# eseopl3patcher

A tool to convert a YM3812 (OPL2) VGM file to a YMF262 (OPL3) VGM file

## Overview

eseopl3patcher is a command-line tool that converts VGM files made for the YM3812 (OPL2) sound chip to OPL3 (YMF262) format. It utilizes the OPL3’s extra channels, adding detuned voices for a chorus effect.

## Features

- Converts YM3812 (OPL2) commands to OPL3 (YMF262) commands
- Applies detuning to the OPL3 extra channels (channels 9–17)
- Automatically appends conversion info and operator information to the GD3 tag
- Simple and flexible command-line usage (argument order is flexible)

## Input Parameters

- VGM file (YM3812/OPL2 format)
- Detune value (percentage, e.g. `2.5` means +2.5% detune, `-1` means -1% detune)
    - Specify the detune value as a percentage. For example: `2.5` = 2.5%, `-1` = -1%.
- KeyOn wait (integer, e.g. `1`). Optional. (Default: `0`)
- Creator string (the string specified here will be appended to the GD3 Creator field). Optional. (Default: `eseopl3patcher`)
- Output file name (`-o output.vgm`). Optional. (Default: `<input>OPL3.vgm`)

### About Detune Value (+/- specification)

- You can specify positive or negative values for the detune value.
    - A positive value (e.g., `2.5`) will raise the pitch of the detuned voices.
    - A negative value (e.g., `-2.5`) will lower the pitch of the detuned voices.
- Example values:
    - `2.5` … Adds +2.5% to the FNumber (higher pitch)
    - `-2.5` … Subtracts -2.5% from the FNumber (lower pitch)

> **The sign of the detune value determines whether the pitch after conversion is raised or lowered. Specify according to your needs.**

## Usage

```sh
eseopl3patcher <input.vgm> <detune> [keyon_wait] [creator] [-o output.vgm]
```

- `<input.vgm>` : VGM file to convert (YM3812/OPL2 format)
- `<detune>` : Detune value (percentage, e.g. `2.5` for +2.5%, `-1` for -1%)
- `[keyon_wait]` : KeyOn wait (integer, optional, default: 0)
- `[creator]` : Creator string (optional, default: "eseopl3patcher")
- `[-o output.vgm]` : Output file name (optional, autogenerated if omitted)

**Argument order is flexible.**  
You can specify `[keyon_wait]`, `[creator]`, and `-o output.vgm` in any order after `<input.vgm>` and `<detune>`.

**Examples:**
```sh
eseopl3patcher song.vgm -1
eseopl3patcher song.vgm 2.5 1
eseopl3patcher song.vgm -1 2 YourName
eseopl3patcher song.vgm -1 YourName
eseopl3patcher song.vgm -1 -o output.vgm
eseopl3patcher song.vgm 1.5 0 YourName -o output.vgm
eseopl3patcher song.vgm -1 -o output.vgm YourName
```

For Japanese README, see [here](https://github.com/emef2247/eseopl3patcher/blob/main/README.ja.md#使い方)

## Download

[![Download for Linux and Windows](https://img.shields.io/github/v/release/emef2247/eseopl3patcher?label=Download%20latest%20release)](https://github.com/emef2247/eseopl3patcher/releases/latest)

You can download pre-built binaries for **Linux** and **Windows** from the [latest release page](https://github.com/emef2247/eseopl3patcher/releases/latest).

## Build

```sh
make win
# or
gcc -O2 -Wall -Iinclude -o eseopl3patcher.exe src/*.c
```

## Author

Created by [@emef2247](https://github.com/emef2247)

## License

MIT License